<!DOCTYPE html>
<html class="light" lang="en" xmlns:th="http://www.thymeleaf.org">
    <head>
        <meta charset="utf-8"/>
        <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
        <title>Login - Smart Meal Planner</title>
        <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
        <link href="https://fonts.googleapis.com" rel="preconnect"/>
        <link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
        <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;700;800&display=swap" rel="stylesheet"/>
        <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" rel="stylesheet"/>

        <script>
            tailwind.config = {
                theme: {
                    extend: {
                        colors: {
                            "nutri-green": "#4CAF50", "deep-forest": "#2E7D32", "card-white": "#FFFFFF",
                            "chef-orange": "#FF7043", "dark-ink": "#263238", "soft-grey": "#78909C",
                            "smart-mist": "#ECEFF1", "smart-white": "#FAFAFA", "error": "#E53935"
                        },
                        fontFamily: {"display": ["Plus Jakarta Sans", "sans-serif"]}
                    }
                }
            };
        </script>
        <style> .material-symbols-outlined {
                font-variation-settings: 'FILL' 0, 'wght' 400, 'GRAD' 0, 'opsz' 24;
            } </style>
    </head>
    <body class="bg-background-light dark:bg-background-dark font-display">
        <div class="relative flex min-h-screen w-full flex-col overflow-x-hidden">
            <div th:replace="~{fragments/navbar_auth :: header_nav}"></div>

            <div class="relative flex min-h-screen w-full flex-col items-center justify-center p-4">
                <div class="w-full max-w-sm">
                    <form th:action="@{/authenticateTheUser}" method="POST" class="flex flex-col gap-8 rounded-xl bg-card-white p-8 shadow-lg border border-smart-mist">

                        <div class="flex flex-col items-center gap-2 text-center">
                            <h2 class="text-3xl font-bold tracking-tight text-dark-ink">Welcome Back</h2>
                            <p class="text-soft-grey text-sm">Please enter your details to sign in.</p>
                        </div>

                        <div th:if="${message}" class="w-full p-4 bg-green-50 border border-green-200 text-green-700 rounded-lg text-sm flex items-center gap-2">
                            <span class="material-symbols-outlined text-base">check_circle</span>
                            <span th:text="${message}"></span>
                        </div>

                        <div th:if="${error}" class="w-full p-4 bg-red-50 border border-red-200 text-error rounded-lg text-sm flex items-center gap-2">
                            <span class="material-symbols-outlined text-base">error</span>
                            <span th:text="${error}">Invalid email or password.</span>
                        </div>

                        <div class="flex flex-col gap-5">
                            <div class="flex flex-col">
                                <label class="mb-1.5 text-sm font-medium text-dark-ink" for="email">Email</label>
                                <div class="relative flex w-full items-center">
                                    <input type="text" name="username" id="email" 
                                           class="form-input h-12 w-full flex-1 rounded-lg border border-smart-mist bg-white px-4 py-2 text-dark-ink placeholder:text-soft-grey focus:border-nutri-green focus:ring-1 focus:ring-nutri-green" 
                                           placeholder="Enter your email" required />
                                </div>
                            </div>

                            <div class="flex flex-col">
                                <label class="mb-1.5 text-sm font-medium text-dark-ink" for="password">Password</label>
                                <div class="relative flex w-full items-center">
                                    <input type="password" name="password" id="password" 
                                           class="form-input h-12 w-full flex-1 rounded-lg border border-smart-mist bg-white px-4 py-2 pr-10 text-dark-ink placeholder:text-soft-grey focus:border-nutri-green focus:ring-1 focus:ring-nutri-green" 
                                           placeholder="Enter your password" required />
                                </div>
                            </div>
                        </div>

                        <div class="flex flex-col gap-4">
                            <button type="submit" class="flex h-12 w-full items-center justify-center rounded-lg bg-nutri-green text-base font-bold text-white transition-all hover:bg-deep-forest hover:shadow-md focus:outline-none focus:ring-2 focus:ring-nutri-green focus:ring-offset-2">
                                Sign In
                            </button>
                            <div class="text-center">
                                <a class="text-sm font-medium text-soft-grey hover:text-nutri-green hover:underline transition-colors" th:href="@{/forgot-password}">Forgot Password?</a>
                            </div>
                        </div>

                        <div class="relative">
                            <div class="absolute inset-0 flex items-center"><div class="w-full border-t border-smart-mist"></div></div>
                            <div class="relative flex justify-center text-sm"><span class="bg-card-white px-2 text-soft-grey">Or</span></div>
                        </div>

                        <p class="text-center text-sm text-soft-grey">Don't have an account? 
                            <a class="font-bold text-nutri-green hover:underline" th:href="@{/register/step1}">Register now</a>
                        </p>
                    </form>
                </div>
            </div>
        </div>

        <script>
            function togglePassword() {
                const passwordInput = document.getElementById('password');
                const icon = document.querySelector('.material-symbols-outlined'); // Chọn icon bên trong nút

                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    // Tùy chọn: đổi icon nếu muốn (ví dụ visibility_off)
                } else {
                    passwordInput.type = "password";
                }
            }
        </script>
    </body>
</html>